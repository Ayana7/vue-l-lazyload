!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["vue-l-lazyload"]=t():e["vue-l-lazyload"]=t()}(window,function(){return function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isArr=s,t.isStr=l,t.isFn=function(e){return"function"==c(e)},t.trim=u,t.each=f,t.on=function t(n,e,r,o){l(e)?n.addEventListener(e,r,o):s(e)&&f(e,function(e){return t(n,e,r,o)})},t.off=function t(n,e,r){l(e)?n.removeEventListener(e,r):s(e)&&f(e,function(e){return t(n,e,r)})},t.className=d,t.addClass=function(e,t){var n=e.classList;if(n)n.add(t);else{var r=d(e).split(" "),o={};f(r,function(e){o[e]=!0}),o[t]||d(e,r.join(" ")+t)}},t.classRE=y,t.removeClass=function t(n,e){if(l(e)){var r=n.classList;if(r)r.remove(e);else{var o=d(n);d(n,u(o.replace(y(e)," ")))}}else s(e)&&f(e,function(e){return t(n,e)})},t.attr=function(e,t,n){e.setAttribute(t,n)},t.removeAttr=function(e,t){e.removeAttribute(t)},t.offset=function(e){var t=e.getBoundingClientRect();return{left:t.left+o.pageXOffset,top:t.top+o.pageYOffset,width:i(t.width),height:i(t.height)}},t.search=function(e,t){return e.indexOf(t)},t.throttle=function(a){var i,c,s=this,l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:250,u=arguments[2];return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=u||s,o=+new Date;i&&o<i+l?(clearTimeout(c),c=setTimeout(function(){i=o,a.apply(r,t)},l)):(i=o,a.apply(r,t))}},t.camelize=p,t.dasherize=v,t.maybeAddPx=h,t.css=function(e,t,n){var r=e.style;{if(arguments.length<3)return r[p(t)]||getComputedStyle(e,"").getPropertyValue(t);n||0===n?r[v(t)]=h(t,n):r.removeProperty(v(t))}};var o=window,a={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},i=Math.round;function c(e){return void 0===e?"undefined":r(e)}function s(e){return e instanceof Array}function l(e){return"string"==c(e)}function u(e){return null==e?"":String.prototype.trim.call(e)}function f(e,t){var n,r,o;for(n=0,r=e.length;n<r;n++)o=e[n],t.call(o,o,n)}function d(e,t){var n=e.className||"",r=n&&void 0!==n.baseVal;if(void 0===t)return r?n.baseVal:n;r?n.baseVal=t:e.className=t}function y(e){return new RegExp("(^|\\s)"+e+"(\\s|$)")}function p(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})}function v(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function h(e,t){return"number"!=c(t)||a[v(e)]?t:t+"px"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VueLLazyload=t.LazyComp=t.Lazy=t.LazyRef=void 0;var l,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=n(0),r=n(2);var o=t.LazyRef={props:{tag:{type:String,default:"div"},opts:{type:Object,default:function(){return{}}}},render:function(e){return e(this.tag,this.$slots.default)},mounted:function(){var e=this.$el;this.$lazy=new l(u({},this.opts,{el:e}))},destroyed:function(){this.$lazy.destroy()},methods:{check:function(){this.$lazy.check()},add:function(e){this.$lazy.addChild(e)},update:function(e){this.$lazy.update(e)},rm:function(e){this.$lazy.rmChild(e)}}},a=t.Lazy={bind:function(o,e,a){var i=e.value;(0,f.isStr)(i)&&(i={src:i}),a._lazyBound=!0;var c=a.context,s=i.ref;c.$nextTick(function(){var e,t;if(a._lazyBound){s&&((e=c.$refs[s])||(t='ref "'+s+'" not found',console.log("v-l-lazyload: "+t)));var n=u({},i,{el:o}),r=e&&e.$lazy;void 0!==r&&(n.parent=r),(a._$lazy=new l(n)).check()}})},componentUpdated:function(e,t,n,r){var o=t.value,a=t.oldValue,i=(0,f.isStr)(o)?o:o.src,c=(0,f.isStr)(a)?a:a.src;if(n!==r&&(n._lazyBound=r._lazyBound,n._$lazy=r._$lazy),i!=c){var s=n._$lazy;s&&s.update({src:i})}},unbind:function(e,t,n){n._lazyBound&&(n._lazyBound=!1),n.context.$nextTick(function(){var e=n._$lazy;e&&(e.destroy(),n._$lazy=null)})}};t.LazyComp={},t.VueLLazyload={install:function(e,t){var n=u({regGlobal:!0},t);l=(0,r.LazyClass)(e),e.$lazy=new l(u({},t,{isRoot:!0})),n.regGlobal&&(e.directive("lazy",a),e.component("lazy-ref",o))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();t.LazyClass=function(f){return function(){function u(e){g(this,u);var t=this,n=e,r=n.isRoot,o=e,a=o.parent;if(r)e=h({el:j,events:[d],classLoading:y,classLoaded:v,classErr:p,classTarget:m,retry:0,once:!0,preloadRatio:1},e);else{var i=f.$lazy;e=h({parent:i},a&&a.opts||i.opts,e)}var c=e,s=c.el,l=c.events;a=e.parent,t.parent=a,t.id=++z,t.el=s,t.stat=b,t._children=[],t._queues={},t._cbs={},t.events=(0,w.isArr)(l)?l:[l],t.opts=e,a&&a.addChild(t)}return r(u,[{key:"check",value:function(e){var t,n,r=this;r.stat<O&&r.inView()&&function(t){var n,r,e=t.opts,o=t.req,a=e.classErr,i=e.classLoaded,c=e.classLoading,s=e.classTarget,l=e.el,u=e.once,f=e.retry,d=e.src,y=e.filters,p=e.onLoad,v=e.onErr,h=e.onReq,g=l,m=[c,a,i],b=s===_&&l.parentNode||l;function z(e,t){(0,w.removeClass)(e,m),(0,w.addClass)(e,t)}switch(o&&o.cancel(),d=(0,w.trim)(d),t.opts.mode){case L:(0,w.css)(l,"background-image",""),n=function(){(0,w.css)(l,"background-image","url("+t.req.src+")")},r=function(){(0,w.css)(l,"background-image","")},g=new Image}d?(t.stat=O,t.req=new k({el:l,loadEl:g,src:d,retry:f,filters:y,onLoad:function(e){n&&n(),t.stat=$,z(b,i),u&&t.destroy(),p&&p(e)},onErr:function(e){r&&r(),e.isEnd&&(t.stat=$,z(b,a),u&&t.destroy()),v&&v(e)},onReq:h}),z(b,c)):(t.stat=$,z(b,i))}(r);var o=r._children;if(o.length){var a=r._queues,i=e?a[e]:o;if(i)for(t=0,n=i.length;t<n;t++){var c=i[t];c.check()}}}},{key:"inView",value:function(){var e=this.parent,t=!1;if(e){var n=e.el,r=this.opts.preloadRatio,o=1-r,a=n===j,i=a?{left:j.pageXOffset,top:j.pageYOffset,width:j.innerWidth,height:j.innerHeight}:(0,w.offset)(n),c=(0,w.offset)(this.el),s=i.left,l=i.top,u=i.width,f=i.height,d=u*o,y=f*o,p=l-y/2,v=s-d/2,h=u+d,g=f+y,m=c.left,b=c.top,z=c.width,_=c.height;m<v+h&&v<m+z&&b<p+g&&p<b+_&&(t=!0)}return t}},{key:"addChild",value:function(e){var t,n,a,r,i=this,o=e.events,c=i.el;function s(e){var t,n,r=i._cbs,o=r[a];o||(o=r[a]=(0,w.throttle)(function(){for(t=0,n=e.length;t<n;t++)e[t].check()})),(0,w.on)(c,a,o,l?{passive:!0}:0)}for(i._children.push(e),t=0,n=o.length;t<n;t++)a=o[t],(r=i._queues[a])||s(r=i._queues[a]=[]),r.push(e)}},{key:"update",value:function(e){var t=this.opts;t.src=e.src,t.once||(this.stat=b,this.check())}},{key:"rmChild",value:function(e){var t,n,r=this._queues,o=this._children,a=Object.keys(r),i=(0,w.search)(o,e);for(0<=i&&o.splice(i,1),t=0,n=a.length;t<n;t++){var c=a[t],s=r[c];if(0<=(i=(0,w.search)(s,e))&&s.splice(i,1),0==s.length){var l=this._cbs,u=l[c];l[c]=null,(0,w.off)(c,u)}}}},{key:"destroy",value:function(){var e=this.parent;this.destroyed||(e&&e.rmChild(this),this.destroyed=!0)}}]),u}()};var w=n(0);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d="scroll",y="lazy-loading",p="lazy-err",v="lazy-loaded",m="self",_="parent",L="bg",b=0,O=1,$=2,j=window,z=0,l=!1;try{var o=Object.defineProperty({},"passive",{get:function(){l=!0}});j.addEventListener("test",null,o)}catch(e){}var k=function(){function v(e){var n=e.el,t=e.loadEl,r=e.src,o=e.retry,a=e.onLoad,i=e.onErr,c=e.onReq,s=e.filters;g(this,v);var l=this;function u(){return{el:n,src:l.src,oSrc:r}}function f(){(0,w.removeAttr)(t,"src"),(0,w.attr)(t,"src",l.src),c&&c(u())}function d(e){i&&i(h({},u(),e))}function y(e){var t=e;return s&&(t=s.reduce(function(e,t){return t(e,{el:n})},e)),t}function p(e){var t=h({failed:!1},e),n=t.failed,r=t.src;n?d():(r&&(l.src=r),f(),l.c++)}l.canceled=!1,l.retry=o,l.c=0,l.src=y(r),t.onload=function(){!l.canceled&&a&&a(u())},t.onerror=function(){if(!l.canceled){var e=l.retry;(0,w.isFn)(e)?(d(),e(h({},u(),{times:l.c,next:p,applyFilters:y}))):-1==e||0<e?(d(),f(),0<e&&l.retry--):d({isEnd:!0})}},f()}return r(v,[{key:"cancel",value:function(){this.canceled=!0}}]),v}()}])});